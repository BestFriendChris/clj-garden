// Lot of classes and stuff and a little tricky.
// Note that this is purely filtering, hence can delay and may want to do
// entirerly in Clojure.